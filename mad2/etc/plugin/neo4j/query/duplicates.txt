//Select all shasums linked to a file
MATCH (s:sha1)<-[r:HAS_SHA1]-(f:file)

//but only for files larger than 1mb
WHERE f.filesize > 1000000

//nosha is the number of files per shasum
//important also is NOT mentioning f - i.e. it's not visible from here on
//  i.e. the count(r) actually aggregates
WITH s, count(r) as nosha

//only those shasums that have more than one file - needed with first
WHERE nosha>1

//second match - now find the files belonging to the shasums selected so far
MATCH (s:sha1)<-[r:HAS_SHA1]-(f2:file)

//return
RETURN s.sha1, f2.filesize, f2.host, f2.fullpath
